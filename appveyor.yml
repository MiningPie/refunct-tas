os: Visual Studio 2015
environment:
  matrix:
    - channel: stable
      target: i686-pc-windows-msvc
    - channel: beta
      target: i686-pc-windows-msvc
    - channel: nightly
      target: i686-pc-windows-msvc
install:
  - appveyor DownloadFile https://win.rustup.rs/ -FileName rustup-init.exe
  - rustup-init -yv --default-toolchain %channel% --default-host %target%
  - set PATH=%PATH%;%USERPROFILE%\.cargo\bin
  - rustup install nightly
  - rustc -vV
  - cargo -vV
build: false
test_script:
  - make.bat
after_test:
  - cd build
  - 7z a practice-windows.zip practice-windows
matrix:
  allow_failures:
    - channel: beta
    - channel: nightly
artifacts:
  - path: build\practice-windows.zip
deploy:
  provider: GitHub
  artifact: /.*\.zip/
  auth_token:
    secure: nLeG+wF9/z56dzElK7NsPMgIetsDaYMP6B3kmRuUpL2iMy1OMNNmkxoBFnj6u2GJ
  draft: true
  on:
    channel: stable
    appveyor_repo_tag: true
